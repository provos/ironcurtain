{
  "generatedAt": "2026-02-17T00:00:00.000Z",
  "constitutionHash": "hand-crafted",
  "rules": [
    {
      "name": "allow-side-effect-free-tools",
      "description": "Pure query tools with no path arguments can always be called",
      "principle": "Least privilege",
      "if": { "sideEffects": false },
      "then": "allow",
      "reason": "Tool has no security-relevant side effects"
    },
    {
      "name": "deny-delete-operations",
      "description": "Block all tools that have delete-path arguments",
      "principle": "No destruction",
      "if": { "roles": ["delete-path"] },
      "then": "deny",
      "reason": "Delete operations are never permitted"
    },
    {
      "name": "allow-read-in-sandbox",
      "description": "Allow reading files within the sandbox directory",
      "principle": "Containment",
      "if": { "paths": { "roles": ["read-path"], "within": "/tmp/ironcurtain-sandbox" } },
      "then": "allow",
      "reason": "Read within sandbox directory"
    },
    {
      "name": "deny-read-elsewhere",
      "description": "Deny reading files outside permitted directories",
      "principle": "Containment",
      "if": { "roles": ["read-path"] },
      "then": "deny",
      "reason": "Read outside permitted directories"
    },
    {
      "name": "allow-write-in-sandbox",
      "description": "Allow writes where all paths are within sandbox",
      "principle": "Containment",
      "if": { "paths": { "roles": ["write-path"], "within": "/tmp/ironcurtain-sandbox" } },
      "then": "allow",
      "reason": "Write within sandbox directory"
    },
    {
      "name": "escalate-write-elsewhere",
      "description": "Writes outside sandbox need human approval",
      "principle": "Human oversight",
      "if": { "roles": ["write-path"] },
      "then": "escalate",
      "reason": "Write outside sandbox requires human approval"
    }
  ]
}
