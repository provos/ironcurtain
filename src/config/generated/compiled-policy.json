{
  "generatedAt": "2026-02-18T02:41:06.057Z",
  "constitutionHash": "d6bf09a1d92525c7d4f99de0760b6abef60ad11f99d35c4fdf50e0d0d59b5e85",
  "inputHash": "ccc24720006751040071d010cda399b43420675dc433e467677b5a96743511a2",
  "rules": [
    {
      "name": "allow-list-allowed-directories",
      "description": "Permit the list_allowed_directories tool unconditionally since it has no side effects and exposes no sensitive data.",
      "principle": "Least privilege",
      "if": {
        "tool": [
          "list_allowed_directories"
        ],
        "sideEffects": false
      },
      "then": "allow",
      "reason": "list_allowed_directories makes no filesystem changes and takes no path arguments; it is always safe to call."
    },
    {
      "name": "deny-all-deletes",
      "description": "Deny any tool invocation that carries a delete-path role argument when it reaches compiled rules (i.e., at least one path is outside the sandbox).",
      "principle": "No destruction",
      "if": {
        "roles": [
          "delete-path"
        ]
      },
      "then": "deny",
      "reason": "Delete operations outside the sandbox are never permitted. If this rule fires, at least one path is outside the sandbox boundary."
    },
    {
      "name": "escalate-reads-outside-sandbox",
      "description": "Escalate read operations whose target path is outside the sandbox to a human approver.",
      "principle": "Human oversight",
      "if": {
        "roles": [
          "read-path"
        ],
        "server": [
          "filesystem"
        ]
      },
      "then": "escalate",
      "reason": "Any read that was not already allowed by the structural sandbox invariant is outside the sandbox and requires explicit human approval."
    },
    {
      "name": "escalate-writes-outside-sandbox",
      "description": "Escalate write operations whose target path is outside the sandbox to a human approver.",
      "principle": "Human oversight",
      "if": {
        "roles": [
          "write-path"
        ],
        "server": [
          "filesystem"
        ]
      },
      "then": "escalate",
      "reason": "Any write that was not already allowed by the structural sandbox invariant is outside the sandbox and requires explicit human approval."
    }
  ]
}
